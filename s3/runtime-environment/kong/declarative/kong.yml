  #
  # TOKEN VALIDATION IS MISSING : Two option to validate tokens
  # - Without making a call (signature verification) See : https://konghq.com/blog/engineering/jwt-kong-gateway
  # https://github.com/callistaenterprise/kong-plugin-token-introspection
  # https://docs.konghq.com/kubernetes-ingress-controller/latest/plugins/custom/
  # - Using introspect endpoint. Sample here See :
  #   NB : Community plugins are not compatible with last version of kong. Handling token validation using introspect endpoint need custom kong plugin implementation
  #

  # Dummy configuration, TODO: correct when plugin OK

_format_version: "3.0"
_transform: true

services:
- name: httpbin_service
  host: httpbin.org
  port: 80
  protocol: http
  routes:
    - name: debug_route
      paths:
        - /debug
      strip_path: true
- name: geo_api_gouv_service
  host: geo.api.gouv.fr
  port: 443
  protocol: https
  path: /communes
  routes:
    - name: communes_route
      paths:
        - /cities
      strip_path: true
  plugins: 
    - name: oauth-liferay-introspect
      config:
        introspection_endpoint: http://apim.dev.local/get
        client_id: id-2ede2606-9967-e3af-db74-4d94c68ebd
        token_header : Bearer eyJ0eXAiOiJhdCtqd3QiLCJhbGciOiJSUzI1NiJ9.eyJqdGkiOiJkY2Y1ZWU1YTNiZmQ1ZTcyMWYyYmU4YmE5YmVlODVmYzc5ZTdkZjkyZmJjZDFlNmVhNDM3NDQ1ZTgyMDQzZTgiLCJjbGllbnRfaWQiOiJpZC0yZWRlMjYwNi05OTY3LWUzYWYtZGI3NC00ZDk0YzY4ZWJkIiwiaWF0IjoxNzE2ODIyNTg0LCJleHAiOjE3MTY4MjMxODQsInN1YiI6IjIwMTIyIiwidXNlcm5hbWUiOiJ0ZXN0IiwiaXNzIjoicG9ydGFsLmRldi5sb2NhbCIsInNjb3BlIjoibGlmZXJheS1qc29uLXdlYi1zZXJ2aWNlcy5hcGltLmNvbW11bmVzLnJlYWQgbGlmZXJheS1qc29uLXdlYi1zZXJ2aWNlcy5hcGltLmh0dHBiaW4ubW9jay5yZWFkIiwiZ3JhbnRfdHlwZSI6ImF1dGhvcml6YXRpb25fY29kZSIsImF1dGhvcml6YXRpb25fY29kZSI6IjM1ZjhiZDRiZGY4M2RlODIyYTdjM2MwYmU4MjFjNDFhZWQ4MjYzNGI2NzJhNDJjOTMxMmI2OTkyZDZhY2E1OTIiLCJjb2RlX3ZlcmlmaWVyIjoiQ012Q213dTVXdEtoIn0.BHO8sI8u090r59xdgMtr9QsOAfaoul-Fl9yv231xgE2WZHFeQXD4QaYBrVyaNWNKKqHlWBv6qgKVXruVTqPSR0ajPcjKfTNIMzKpd0UBDHNgQ5oS8qZYkj9-MnABoM5ZKV49Qgq9j477h43g0bztGhNigELOWcM2ROtDJeWQ7NJFEiLgtzgzkjQxq0P5aZLvolHHgtzYp4fYPfUIjsq-Wn1hb3BUF6fknvLd7NE_WAG7Qes9iu4YjqBOlusYWHHdXkDN4ivRVyKbQqtiLZnkOaGjuQzekThNGFZESaGEw3rUl5ldkpjrQDMHTfCxttwYMPKurwbdgGbTVpk3DPcdxg